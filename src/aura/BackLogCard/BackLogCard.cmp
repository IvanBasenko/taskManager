<!--
 - Created by Ivan Basenko on 23.10.2018.
 -->

<aura:component description="BackLogCard" controller="TaskCardController">
    <aura:attribute name="taskCard" type="TaskCard__c"/>
    <aura:registerEvent name="RefreshBackLog" type="c:RefreshBackLogEvent"/>
    <aura:attribute name="isOpen" type="boolean" default="false"/>
    <aura:handler name="changeRecordType" event="c:ChangeRecordTypeEvent" action="{!c.changeType}"/>
    <lightning:recordViewForm aura:id="viewForm" recordId="{!v.taskCard.Id}" objectApiName="TaskCard__c">
        <lightning:card>
            <aura:set attribute="title">
                <lightning:layout class="slds-p-around--xxx-small" horizontalAlign="spread" verticalAlign="start">
                    <lightning:layoutItem>
                        <h3 class="slds-page-header__title">{!v.taskCard.Name}</h3>
                    </lightning:layoutItem>
                    <lightning:layoutItem>
                        <lightning:button label="Edit" onclick="{!c.editRecord}"/>
                        <lightning:button label="Delete" variant="destructive" onclick="{!c.deleteRecord}"/>
                    </lightning:layoutItem>
                </lightning:layout>
            </aura:set>

            <p class="slds-p-around--medium">
                <lightning:layout horizontalAlign="spread" verticalAlign="end">
                    <lightning:layoutItem>
                        <span class="outputStyle"><lightning:outputField fieldName="Task_Name__c"/></span>
                        <span class="outputStyle"><lightning:outputField fieldName="Description__c"/></span>
                    </lightning:layoutItem>
                    <lightning:layoutItem>
                        <lightning:button label="Add to sprint" variant="brand" onclick="{!c.addToSprint}"/>
                    </lightning:layoutItem>
                </lightning:layout>
            </p>
        </lightning:card>

    </lightning:recordViewForm>
    <lightning:recordEditForm aura:id="editForm" recordId="{!v.taskCard.Id}" objectApiName="TaskCard__c"
                              class="slds-hide" onsuccess="{!c.handleSuccess}">
        <lightning:card>
            <aura:set attribute="title">
                <lightning:layout class="slds-p-around--xxx-small" horizontalAlign="spread" verticalAlign="start">
                    <lightning:layoutItem>
                        <h3 class="slds-page-header__title">{!v.taskCard.Name}</h3>
                    </lightning:layoutItem>
                </lightning:layout>
            </aura:set>
            <div class="slds-media">
                <div class="slds-media__body slds-p-around--medium">
                    <lightning:inputField fieldName="Task_Name__c"/>
                    <lightning:inputField fieldName="Description__c"/>
                    <lightning:layout horizontalAlign="center" class="slds-m-top_large">
                        <lightning:button variant="neutral" label="Cancel" title="Cancel"
                                          onclick="{!c.handleCancel}"/>
                        <lightning:button variant="brand" label="Submit" title="Submit" type="submit"/>
                    </lightning:layout>
                </div>
            </div>
        </lightning:card>
    </lightning:recordEditForm>
    <c:AddToSprintModalWindow isOpen="{!v.isOpen}" taskCard="{!v.taskCard}"/>
</aura:component>
